---
import MainLayout from "../../../layouts/MainLayout.astro";
import { getCollection} from "astro:content";
import type { CollectionEntry } from "astro:content";
import ArticleCard from "../../../components/ArticleCard.astro";
import { capitalize } from "../../../utils";

// Get the tag from the URL parameters
const { tag } = Astro.params;
// Validate that tag exists
if (tag === undefined) {
  throw new Error("Tag parameter is required");
}
const allBlogArticles: CollectionEntry<'blog'>[] = (await getCollection('blog')).sort((a,b) =>b.data.pubDate.valueOf() - a.data.pubDate.valueOf() );
// console.log(allBlogArticles[0]);
const tagArticles = allBlogArticles.filter((article) =>article.data.tags.includes(tag) )
---
<MainLayout>
    <a
          class="bg-gray-100 inline-block p-2 hover:bg-indigo-500 hover:text-white rounded transition"
          href="/articles"
          >ğŸ‘ˆğŸ»Ãnapoi La Toate Articolele
    </a>
 <div class="my-4">
        <h1 class="text-xl font-bold"># {capitalize(tag)}</h1>
</div>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2">
       {tagArticles.map((article)=>( 
      <ArticleCard article={article}/>
      ))}
    </div>
   
</MainLayout>